{
    "img_size": 640,
    "num_class": 80,
    "anchor": {
        "reg_max": 16,
        "strides": [
            8,
            16,
            32
        ]
    },
    "model": {
        "backbone": [
            {
                "conv_block": {
                    "inputs": [
                        "input"
                    ],
                    "args": {
                        "out_channels": 64,
                        "kernel_size": 3,
                        "strides": 2
                    },
                    "tag": "B1"
                }
            },
            {
                "conv_block": {
                    "inputs": [
                        "B1"
                    ],
                    "args": {
                        "out_channels": 128,
                        "kernel_size": 3,
                        "strides": 2
                    },
                    "tag": "CB1B"
                }
            },
            {
                "rep_ncspelan": {
                    "inputs": [
                        "CB1B"
                    ],
                    "args": {
                        "out_channels": 256,
                        "part_channels": 128
                    },
                    "tag": "B2"
                }
            },
            {
                "adown": {
                    "inputs": [
                        "B2"
                    ],
                    "args": {
                        "out_channels": 256
                    },
                    "tag": "AD1B"
                }
            },
            {
                "rep_ncspelan": {
                    "inputs": [
                        "AD1B"
                    ],
                    "args": {
                        "out_channels": 512,
                        "part_channels": 256
                    },
                    "tag": "B3"
                }
            },
            {
                "adown": {
                    "inputs": [
                        "B3"
                    ],
                    "args": {
                        "out_channels": 512
                    },
                    "tag": "AD2B"
                }
            },
            {
                "rep_ncspelan": {
                    "inputs": [
                        "AD2B"
                    ],
                    "args": {
                        "out_channels": 512,
                        "part_channels": 512
                    },
                    "tag": "B4"
                }
            },
            {
                "adown": {
                    "inputs": [
                        "B4"
                    ],
                    "args": {
                        "out_channels": 512
                    },
                    "tag": "AD3B"
                }
            },
            {
                "rep_ncspelan": {
                    "inputs": [
                        "AD3B"
                    ],
                    "args": {
                        "out_channels": 512,
                        "part_channels": 512
                    },
                    "tag": "B5"
                }
            }
        ],
        "neck": [
            {
                "sppelan": {
                    "inputs": [
                        "B5"
                    ],
                    "args": {
                        "out_channels": 512
                    },
                    "tag": "N3"
                }
            },
            {
                "upsample": {
                    "inputs": [
                        "N3"
                    ],
                    "args": {
                        "scale_factor": 2,
                        "mode": "nearest"
                    },
                    "tag": "UP1N"
                }
            },
            {
                "concat": {
                    "inputs": [
                        "UP1N",
                        "B4"
                    ],
                    "tag": "CC1N"
                }
            },
            {
                "rep_ncspelan": {
                    "inputs": [
                        "CC1N"
                    ],
                    "args": {
                        "out_channels": 512,
                        "part_channels": 512
                    },
                    "tag": "N4"
                }
            },
            {
                "upsample": {
                    "inputs": [
                        "N4"
                    ],
                    "args": {
                        "scale_factor": 2,
                        "mode": "nearest"
                    },
                    "tag": "UP2N"
                }
            },
            {
                "concat": {
                    "inputs": [
                        "UP2N",
                        "B3"
                    ],
                    "tag": "CC2N"
                }
            }
        ],
        "head": [
            {
                "rep_ncspelan": {
                    "inputs": [
                        "CC2N"
                    ],
                    "args": {
                        "out_channels": 256,
                        "part_channels": 256
                    },
                    "tag": "P3"
                }
            },
            {
                "adown": {
                    "inputs": [
                        "P3"
                    ],
                    "args": {
                        "out_channels": 256
                    },
                    "tag": "AD1H"
                }
            },
            {
                "concat": {
                    "inputs": [
                        "AD1H",
                        "N4"
                    ],
                    "tag": "CC1H"
                }
            },
            {
                "rep_ncspelan": {
                    "inputs": [
                        "CC1H"
                    ],
                    "args": {
                        "out_channels": 512,
                        "part_channels": 512
                    },
                    "tag": "P4"
                }
            },
            {
                "adown": {
                    "inputs": [
                        "P4"
                    ],
                    "args": {
                        "out_channels": 512
                    },
                    "tag": "AD2H"
                }
            },
            {
                "concat": {
                    "inputs": [
                        "AD2H",
                        "N3"
                    ],
                    "tag": "CC2H"
                }
            },
            {
                "rep_ncspelan": {
                    "inputs": [
                        "CC2H"
                    ],
                    "args": {
                        "out_channels": 512,
                        "part_channels": 512
                    },
                    "tag": "P5"
                }
            }
        ],
        "prediction": [
            {
                "rep_ncspelan": {
                    "inputs": [
                        "P3"
                    ],
                    "args": {
                        "out_channels": 256,
                        "part_channels": 256,
                        "csp_args": {
                            "repeat_num": 2
                        }
                    },
                    "tag": "RNE1P"
                }
            },
            {
                "upsample": {
                    "inputs": [
                        "RNE1P"
                    ],
                    "args": {
                        "scale_factor": 2,
                        "mode": "nearest"
                    },
                    "tag": "UP1P"
                }
            },
            {
                "conv_block": {
                    "inputs": [
                        "UP1P"
                    ],
                    "args": {
                        "out_channels": 256,
                        "kernel_size": 3
                    },
                    "tag": "PT1P"
                }
            },
            {
                "multihead_segmentation": {
                    "inputs": [
                        "P3",
                        "P4",
                        "P5",
                        "PT1P"
                    ],
                    "args": {
                        "num_masks": 32
                    },
                    "tag": "main",
                    "output": true
                }
            }
        ],
        "auxiliary": [
            {
                "cb_linear": {
                    "inputs": [
                        "B3"
                    ],
                    "args": {
                        "out_channels": [
                            256
                        ]
                    },
                    "tag": "R3"
                }
            },
            {
                "cb_linear": {
                    "inputs": [
                        "B4"
                    ],
                    "args": {
                        "out_channels": [
                            256,
                            512
                        ]
                    },
                    "tag": "R4"
                }
            },
            {
                "cb_linear": {
                    "inputs": [
                        "B5"
                    ],
                    "args": {
                        "out_channels": [
                            256,
                            512,
                            512
                        ]
                    },
                    "tag": "R5"
                }
            },
            {
                "conv_block": {
                    "inputs": [
                        "input"
                    ],
                    "args": {
                        "out_channels": 64,
                        "kernel_size": 3,
                        "strides": 2
                    },
                    "tag": "A1"
                }
            },
            {
                "conv_block": {
                    "inputs": [
                        "A1"
                    ],
                    "args": {
                        "out_channels": 128,
                        "kernel_size": 3,
                        "strides": 2
                    },
                    "tag": "CB1A"
                }
            },
            {
                "rep_ncspelan": {
                    "inputs": [
                        "CB1A"
                    ],
                    "args": {
                        "out_channels": 256,
                        "part_channels": 128
                    },
                    "tag": "A2"
                }
            },
            {
                "adown": {
                    "inputs": [
                        "A2"
                    ],
                    "args": {
                        "out_channels": 256
                    },
                    "tag": "AD1A"
                }
            },
            {
                "cb_fuse": {
                    "inputs": [
                        [
                            "R3",
                            "R4",
                            "R5"
                        ],
                        "AD1A"
                    ],
                    "args": {
                        "indices": [
                            0,
                            0,
                            0
                        ]
                    },
                    "tag": "CF1A"
                }
            },
            {
                "rep_ncspelan": {
                    "inputs": [
                        "CF1A"
                    ],
                    "args": {
                        "out_channels": 512,
                        "part_channels": 256
                    },
                    "tag": "A3"
                }
            },
            {
                "adown": {
                    "inputs": [
                        "A3"
                    ],
                    "args": {
                        "out_channels": 512
                    },
                    "tag": "AD2A"
                }
            },
            {
                "cb_fuse": {
                    "inputs": [
                        [
                            "R4",
                            "R5"
                        ],
                        "AD2A"
                    ],
                    "args": {
                        "indices": [
                            1,
                            1
                        ]
                    },
                    "tag": "CF2A"
                }
            },
            {
                "rep_ncspelan": {
                    "inputs": [
                        "CF2A"
                    ],
                    "args": {
                        "out_channels": 512,
                        "part_channels": 512
                    },
                    "tag": "A4"
                }
            },
            {
                "adown": {
                    "inputs": [
                        "A4"
                    ],
                    "args": {
                        "out_channels": 512
                    },
                    "tag": "AD3A"
                }
            },
            {
                "cb_fuse": {
                    "inputs": [
                        [
                            "R5"
                        ],
                        "AD3A"
                    ],
                    "args": {
                        "indices": [
                            2
                        ]
                    },
                    "tag": "CF3A"
                }
            },
            {
                "rep_ncspelan": {
                    "inputs": [
                        "CF3A"
                    ],
                    "args": {
                        "out_channels": 512,
                        "part_channels": 512
                    },
                    "tag": "A5"
                }
            },
            {
                "rep_ncspelan": {
                    "inputs": [
                        "A3"
                    ],
                    "args": {
                        "out_channels": 512,
                        "part_channels": 256,
                        "csp_args": {
                            "repeat_num": 2
                        }
                    },
                    "tag": "RNE1A"
                }
            },
            {
                "upsample": {
                    "inputs": [
                        "RNE1A"
                    ],
                    "args": {
                        "scale_factor": 2,
                        "mode": "nearest"
                    },
                    "tag": "UP1A"
                }
            },
            {
                "conv_block": {
                    "inputs": [
                        "UP1A"
                    ],
                    "args": {
                        "out_channels": 256,
                        "kernel_size": 3
                    },
                    "tag": "PT1A"
                }
            },
            {
                "multihead_segmentation": {
                    "inputs": [
                        "A3",
                        "A4",
                        "A5",
                        "PT1A"
                    ],
                    "args": {
                        "num_masks": 32
                    },
                    "tag": "aux",
                    "output": true
                }
            }
        ]
    }
}